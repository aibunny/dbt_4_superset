- name: active_portfolio_metrics
    model: ref('active_portfolio')
    description: "This semantic model represents the active portfolio, including various financial and customer-related metrics."
    entities:
      - name: id
        type: primary
    measures:
      - name: total_loan_amount
        description: "Total loan amount in the active portfolio."
        aggregation: sum
        expression: sum(loan_amount)
      - name: total_loan_count
        description: "Total loan count in the active portfolio."
        aggregation: count
        expression: count(*)
      - name: average_loan_amount
        description: "Average loan amount in the active portfolio."
        aggregation: avg
        expression: avg(loan_amount)
      - name: total_loan_amount_by_product
        description: "Total loan amount by product in the active portfolio."
        aggregation: sum
        expression: sum(loan_amount)
        dimensions:
          - name: product_name
            type: string
            expr: product
      - name: total_loan_amount_by_debtor_gender
        description: "Total loan amount by debtor gender in the active portfolio."
        aggregation: sum
        expression: sum(loan_amount)
        dimensions:
          - name: debtor_gender
            type: string
            expr: debtor_gender
